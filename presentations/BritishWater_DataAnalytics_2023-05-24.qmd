---
title: "Sewage spill Event Duration Monitoring"
subtitle: "Through the eyes of a citizen scientist"
author: "Leo Kiernan"
date: "2023-05-24"
draft: true
date-format: iso
format:
  revealjs: 
    slide-number: true
    chalkboard: 
      buttons: false
    preview-links: auto
    css: styles.css
    footer: <https://leo037.quarto.pub/leos-blog/>
resources:
  - demo.pdf
---

## Bringing open-data to life ...

-   I started by [writing a blog](https://leo037.quarto.pub/leos-blog/) about a new open-data source from Thames Water on Event Duration Monitors (EDMs)

-   ... but ended up [building an app](https://drleo037.shinyapps.io/openRivers/ "link to the openRivers app") that allowed the dataset to be explored in the context of other open data

[![](images/interactiveApp.png){fig-align="center"}](https://drleo037.shinyapps.io/openRivers/)

## Contents {chalkboard-buttons="true"}

-   A short hands-on demo of:
    -   An [interactive app](https://drleo037.shinyapps.io/openRivers/ "link to the openRivers app") showing rivers, river flows & EMDs
    -   Detailed [posts](https://leo037.quarto.pub/leos-blog/ "link to a blog on the components of the app") on how all this was implemented
-   Deeper dive into the datasets used and they we joined
-   Discussion:
    -   Handling open-data: The good, the bad and the ugly
    -   The future of open-data. Transparency, trust and innovation

## open-data sources used in the app {chalkboard-buttons="true" auto-animate="true" auto-animate-easing="ease-in-out"}

::: r-vstack
::: {data-id="box1" auto-animate-delay="0" style="background: #cfcece; font-size: 30px; width: 600px; height: 130px; margin: 10px; text-align: center;"}
Open Streetmap<br> =\> Background maps \<=<br>(where)
:::

::: {data-id="box2" auto-animate-delay="0.1" style="background: #2780e3; font-size: 30px; width: 600px; height: 130px; margin: 10px; text-align: center;"}
Ordnance Survey<br> =\> River Networks \<=<br>(what, where, connectivity, direction)
:::

::: {data-id="box3" auto-animate-delay="0.2" style="background: #3fb618; font-size: 30px; width: 600px; height: 130px; margin: 10px; text-align: center;"}
Environment Agency<br> =\> Rivers flows \<= <br>(levels, rainfall, where when, what)
:::

::: {data-id="box4" auto-animate-delay="0.3" style="background: #e83e8c; font-size: 30px; width: 600px; height: 130px; margin: 10px; text-align: center;"}
Thames Water<br> =\> EDMs \<= <br>(where, when, what)
:::
:::

## Building a coherent data environment {chalkboard-buttons="true" auto-animate="true" auto-animate-easing="ease-in-out"}

::: r-stack
::: {data-id="box1" style="background: #cfcece; width: 450px; height: 450px; border-radius: 200px; text-align: center;"}
OSM
:::

::: {data-id="box2" style="background: #2780e3; width: 350px; height: 350px; border-radius: 200px; text-align: center;"}
OS
:::

::: {data-id="box3" style="background: #3fb618; width: 250px; height: 250px; border-radius: 200px; text-align: center;"}
EA
:::

::: {data-id="box4" style="background: #e83e8c; width: 150px; height: 150px; border-radius: 200px; text-align: center;"}
TW
:::
:::

Each data-source builds on the previous to add context

~*\*\ The\ app\ also\ used\ water\ company\ boundaries\ and\ EDM\ Annual\ Return\ summaries*~

## The main datasets (OSM) {chalkboard-buttons="true" auto-animate="true" auto-animate-easing="ease-in-out"}

::: columns
::: {.column width="30%"}
::: r-vstack
::: {data-id="box1" auto-animate-delay="0" style="background: #cfcece; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
<b>Open Streetmap<br> =\> Background maps \<=<br>Geospatial background map</b>
:::

::: {data-id="box2" auto-animate-delay="0.1" style="background: #2780e3; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Ordnance Survey<br> =\> River Networks \<=<br>Geospatial & Topological
:::

::: {data-id="box3" auto-animate-delay="0.2" style="background: #3fb618; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Environment Agency<br> =\> Rivers flows \<= <br>Geospatial, Temporal
:::

::: {data-id="box4" auto-animate-delay="0.3" style="background: #e83e8c; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Thames Water<br> =\> EDMs \<= <br>Geospatial, Temporal
:::
:::
:::

::: {.column width="10%"}
:::

::: {.column width="60%"}
[![](images/interactiveApp.png){fig-align="center"}](https://drleo037.shinyapps.io/openRivers/)
:::
:::

## The main datasets (OS) {chalkboard-buttons="true" auto-animate="true" auto-animate-easing="ease-in-out"}

::: columns
::: {.column width="30%"}
::: r-vstack
::: {data-id="box1" auto-animate-delay="0" style="background: #cfcece; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Open Streetmap<br> =\> Background maps \<=<br>Geospatial background map
:::

::: {data-id="box2" auto-animate-delay="0.1" style="background: #2780e3; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
<b>Ordnance Survey<br> =\> River Networks \<=<br>Geospatial & Topological</b>
:::

::: {data-id="box3" auto-animate-delay="0.2" style="background: #3fb618; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Environment Agency<br> =\> Rivers flows \<= <br>Geospatial, Temporal
:::

::: {data-id="box4" auto-animate-delay="0.3" style="background: #e83e8c; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Thames Water<br> =\> EDMs \<= <br>Geospatial, Temporal
:::
:::
:::

::: {.column width="30%"}
[![](images/OS%20uk%20rivers_200.png){fig-align="right"}](https://drleo037.shinyapps.io/openRivers/)
:::

::: {.column width="40%"}
[![](images/directional_rivers_london.png){fig-align="right"}](https://drleo037.shinyapps.io/openRivers/)
:::
:::

## The main datasets (EA) {chalkboard-buttons="true" auto-animate="true" auto-animate-easing="ease-in-out"}

::: columns
::: {.column width="30%"}
::: r-vstack
::: {data-id="box1" auto-animate-delay="0" style="background: #cfcece; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Open Streetmap<br> =\> Background maps \<=<br>Geospatial background map
:::

::: {data-id="box2" auto-animate-delay="0.1" style="background: #2780e3; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Ordnance Survey<br> =\> River Networks \<=<br>Geospatial & Topological
:::

::: {data-id="box3" auto-animate-delay="0.2" style="background: #3fb618; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
<b>Environment Agency<br> =\> Rivers flows \<= <br>Geospatial, Temporal</b>
:::

::: {data-id="box4" auto-animate-delay="0.3" style="background: #e83e8c; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Thames Water<br> =\> EDMs \<= <br>Geospatial, Temporal
:::
:::
:::

::: {.column width="10%"}
:::

::: {.column width="60%"}
[![](images/river_levels400.png){fig-align="right"}](https://drleo037.shinyapps.io/openRivers/) [![](images/river-loadings1200.png){fig-align="right"}](https://drleo037.shinyapps.io/openRivers/)
:::
:::

## The main datasets (TW) {chalkboard-buttons="true" auto-animate="true" auto-animate-easing="ease-in-out"}

::: columns
::: {.column width="30%"}
::: r-vstack
::: {data-id="box1" auto-animate-delay="0" style="background: #cfcece; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Open Streetmap<br> =\> Background maps \<=<br>Geospatial background map
:::

::: {data-id="box2" auto-animate-delay="0.1" style="background: #2780e3; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Ordnance Survey<br> =\> River Networks \<=<br>Geospatial & Topological
:::

::: {data-id="box3" auto-animate-delay="0.2" style="background: #3fb618; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
Environment Agency<br> =\> Rivers flows \<= <br>Geospatial, Temporal
:::

::: {data-id="box4" auto-animate-delay="0.3" style="background: #e83e8c; font-size: 30px; width:  400px; height: 130px; margin: 10px; text-align: center;"}
<b>Thames Water<br> =\> EDMs \<= <br>Geospatial, Temporal</b>
:::
:::
:::

::: {.column width="10%"}
:::

::: {.column width="60%"}
[![](images/EDMs300.png){fig-align="right"}](https://drleo037.shinyapps.io/openRivers/) [![](images/TW%20river%20loadings.png){fig-align="center"}](https://drleo037.shinyapps.io/openRivers/)
:::
:::

## Handling open-data (the good) {chalkboard-buttons="true"}

-   **Good:**

    -   APIs promote reproducibility

    -   Where possible decorate data with context / meaning (e.g. [EA API](https://environment.data.gov.uk/flood-monitoring/doc/reference#introduction) json-ld, [units](https://qudt.org/) etc.)

    -   Some APIs leave a trail of breadcrumbs (e.g. EA API results for the [River Thames](https://environment.data.gov.uk/flood-monitoring/id/stations?riverName=River%20Thames))

-   Bad:

-   Ugly:

## Handling open-data (the bad) {chalkboard-buttons="true"}

-   Good:

-   **Bad:**

    -   Mostly, you're on your own. no SMEs

    -   Some terms of service limit use and might discourage innovation ([example](https://data.thameswater.co.uk/s/terms-of-service))

    -   (to my knowledge) endpoints are not yet push / streaming / publish-and-subscribe.

-   Ugly:

## Handling open-data (the good) {chalkboard-buttons="true"}

-   Good:

-   Bad:

-   **Ugly:**

    -   Dealing with a range of sources:

        -   Different styles of end-points (files, services, APIs)

        -   Some formats are more complex than others (I struggled with nested JSON, but ...)

    -   Dealing with lots of data (even from the same source):

        -   Some formats change over time (even within a single doc)

        -   Some datasets have internal inconsistencies (tough to handle without SMEs)

    -   I had to make some grand assumptions (never a good thing)

        -   Sure, the usual stuff ... outliers (errors or interesting?)

        -   Even in something as simple as counting events

        -   Whether to join parts of river systems together

## The future of open data?

Open-data is just one slice of a much wider data spectrum. The Open Data Institute ([ODI](https://theodi.org/about-the-odi/the-data-spectrum/)) have created excellent graphics summarising the [data spectrum](https://drive.google.com/drive/u/0/folders/1BzM_aV9B6d1AwQ1wf02vYW4XVDlGlFbO) that can be shared under [Creative Commons](https://creativecommons.org/licenses/) licences

Points for discussion:

-   The values of open-data include : Transparency, Trust, Innovation

-   But there are costs including: Financial, Reputational, Processing, Support and documenation

## Other resources {chalkboard-buttons="true"}

-   [Environment Agency: (Annualised) Storm Overflows](https://environment.data.gov.uk/dataset/21e15f12-0df8-4bfc-b763-45226c16a8ac)

-   [Thames Water: (interactive map) Near real-time map](https://www.thameswater.co.uk/edm-map)

-   [Thames Water: (context and signposts) on river health](https://www.thameswater.co.uk/about-us/performance/river-health)

-   [South West Water: interactive map called "waterfit" health](https://www.southwestwater.co.uk/environment/waterfit/waterfitlive/)

-   [The rivers trust: (interactive map) Is my river fit to play in?](https://experience.arcgis.com/experience/e834e261b53740eba2fe6736e37bbc7b/page/home/)

-   [Surfers Against Sewage: (interactive map) Pollution alerts](https://www.sas.org.uk/water-quality/sewage-pollution-alerts/)

-   [Top of the poops (maps, code & other visuals)](https://top-of-the-poops.org/)

## About this presentation

This presentation was built with Quarto and [Reveal.js](https://revealjs.com), including:

-   Presenting code and LaTeX equations
-   Including computations in slide output
-   Image, video, and iframe backgrounds
-   Fancy transitions and animations
-   Printing to PDF

...and much more
